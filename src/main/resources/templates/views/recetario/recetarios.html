<html layout:decorate="~{layout/layout_base}">
    <head>
        <title>Mis recetarios</title>
    </head>
    <body>
        <div layout:fragment="content">
            <br>
            <!-- MIS RECETARIOS -->
            <div class="container">

                <!-- Carrusel
                <div class="recuadro_recetario">
                    <h2>Últimas recetas</h2>
                </div>
                <div class="Carousel recuadro_recetario">
                    <div class="slick-list" id="slick-list">
                        <button class="slick-arrow slick-prev" id="button-prev" data-button="button-prev" onclick="app.processingButton(event)">
                            <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="chevron-left"
                                 class="svg-inline--fa fa-chevron-left fa-w-10" role="img" xmlns="http://www.w3.org/2000/svg"
                                 viewBox="0 0 320 512">
                                <path fill="currentColor"
                                      d="M34.52 239.03L228.87 44.69c9.37-9.37 24.57-9.37 33.94 0l22.67 22.67c9.36 9.36 9.37 24.52.04 33.9L131.49 256l154.02 154.75c9.34 9.38 9.32 24.54-.04 33.9l-22.67 22.67c-9.37 9.37-24.57 9.37-33.94 0L34.52 272.97c-9.37-9.37-9.37-24.57 0-33.94z">
                                </path>
                            </svg>
                        </button>
                        <div class="slick-track" id="track" th:each="item, iStat : ${recetaList}">

                            <div class="slick">
                                <div >
                                    <a th:href="@{'/ver-mi-receta/'+${item.idReceta}}">
                                        <picture>
                                            <img th:if="${#strings.contains(item.imagenes, 'default.jpg')}" th:src="@{'/uploads/default.jpg'}" th:class="'imagenCard'+${iStat.count}" style="border:none; width: 100%; height: 200px;"/>
                                            <img th:unless="${#strings.contains(item.imagenes, 'default.jpg')}" th:src="@{'/uploads/'+${#strings.replace(item.titulo, ' ', '')}+'/'+${#strings.substringBefore(item.imagenes,';')}}" th:class="'imagenCard'+${iStat.count}" style="border:none; width: 100%; height: 200px;"/>
                                        </picture>
                                    </a>
                                </div>
                            </div>
                        </div>
                        <button class="slick-arrow slick-next" id="button-next" data-button="button-next" onclick="app.processingButton(event)">
                            <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="chevron-right"
                                 class="svg-inline--fa fa-chevron-right fa-w-10" role="img" xmlns="http://www.w3.org/2000/svg"
                                 viewBox="0 0 320 512">
                                <path fill="currentColor"
                                      d="M285.476 272.971L91.132 467.314c-9.373 9.373-24.569 9.373-33.941 0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941 0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z">
                                </path>
                            </svg>
                        </button>
                    </div>
                </div>
                -->
                <!-- RECETARIOS -->
                <div class="recuadro_recetario">
                    <h2>Mis recetarios
                        <button type="button" style="border:none; background: none; color:#e0727b; outline: none" data-bs-toggle="modal" data-bs-target="#exampleModal" data-bs-whatever="@mdo" >
                            <i class="fas fa-plus-circle" data-bs-toggle="tooltip" data-bs-placement="right" title="Crear nuevo recetario"></i>
                        </button>
                    </h2>
                </div>

                <div style="padding: 20px;">
                    <div style="background-color: #f3ecf3; margin-top: 15px; margin-bottom: 15px; padding: 25px;" th:each="item : ${recetarioList}" >
                        <a th:href="@{'/ver-recetas/'+${item.idRecetario}}" style="text-decoration: none; color:#8a8f97;">
                            <br>
                            <div class="d-flex w-100 justify-content-between">
                                <h5 style="font-size: 18pt;" class="mb-1" th:text="${item.nombre}"></h5>
                                <small><a href="#" style="display: inline; text-decoration: none; color:#8a8f97; font-size: 15pt;"><i class="fas fa-times"></i></a></small>
                            </div>
                            <br>
                        </a>
                    </div>
                </div>
                <!-- RECETARIOS -->


                <!-- RECETARIOS GUARDADOS -->
                <div class="recuadro_recetario">
                    <h2>Recetarios guardados</h2>
                </div>

                <div style="padding: 20px;">
                    <div style="background-color: #f3ecf3; margin-top: 15px; margin-bottom: 15px; padding: 25px;" th:each="item : ${ufrList}">
                        <a th:href="@{'/ver-recetas-seguidas/'+${item.recetario.idRecetario}}" style="text-decoration: none; color:#8a8f97;">
                            <br>
                            <div class="d-flex w-100 justify-content-between">
                                <h5 style="font-size: 18pt;" th:text="${item.recetario.nombre}"></h5>
                                <small><a th:href="@{'/dejar-seguir-recetario/'+${item.recetario.idRecetario}}" style="display: inline; text-decoration: none; color:#8a8f97; font-size: 15pt;"><i class="fas fa-heart-broken"></i></a></small>
                            </div>
                            <br>
                        </a>
                    </div>
                </div>
                <!-- RECETARIOS GUARDADOS -->
            </div>

            <!-- Model -->
            <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="exampleModalLabel">Nuevo recetario</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <form id="recetario-form" th:action="@{/registrar-recetario}" method="post" th:object="${recetario}">
                            <div class="modal-body">
                                <div class="mb-3">
                                    <label for="recipient-name" class="col-form-label">Nombre del recetario:</label>
                                    <input type="text" class="form-control" id="recipient-name" th:field="*{nombre}">
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button class="btnCancelar" data-bs-dismiss="modal">Cancelar</button>
                                <button class="botonPer" type="submit" id="btnGuardar">Guardar</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            <!-- Model-->
            <script th:if="${exito}" type="text/javascript">
                toastr.success('Se registró con exito!', 'Exito');
            </script>
            <script th:if="${mensajeError}">
                toastr.error("Solo se aceptan letras","Error");
            </script>
            <script type="text/javascript">
                $("#btnGuardar").on('click',function (e) {
                    if(document.getElementById("recipient-name").value == ""){
                        toastr.warning("No puede ir vacio","Error");
                        document.getElementById("recipient-name").focus()
                        e.preventDefault()
                    }

                })
            </script>
            <script th:if="${eliminarRecetario}" type="text/javascript">
                toastr.error('Necesita eliminar sus recetas del recetario para eliminarlo', 'Error');
            </script>
            <script th:if="${eliminado}" type="text/javascript">
                toastr.success('Recetario eliminado con exito!', 'Exito');
            </script>
            <script th:if="${dejarSeguirRecetario}" type="text/javascript">
                toastr.success('Dejo de seguir el recetario', 'Exito');
            </script>
        </div>
    </body>
    </html>